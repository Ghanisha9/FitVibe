<script>
    const signupForm = document.getElementById('signupForm');
    const notification = document.getElementById('notification');
    const MIN_PASSWORD_LENGTH = 6;
    const API_URL = "http://localhost:5000/api/auth/signup"; // Your Backend API URL

    function showToast(message, isError = false) {
      notification.textContent = message;
      notification.classList.toggle('error', isError);
      notification.style.display = 'block';
      setTimeout(() => {
        notification.style.display = 'none';
      }, 2500);
    }

    signupForm.addEventListener('submit', async function (e) {
      e.preventDefault();

      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim().toLowerCase();
      const password = document.getElementById('password').value;

      if (!name || !email || !password) {
        showToast("Please fill all fields", true);
        return;
      }

      if (password.length < MIN_PASSWORD_LENGTH) {
        showToast(`Password must be at least ${MIN_PASSWORD_LENGTH} characters long.`, true);
        return;
      }

      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ name, email, password })
        });

        const data = await response.json();

        if (response.ok) {
          // SUCCESS - User saved to MongoDB
          showToast(data.msg || "Sign up successful! Redirecting to login...");
          setTimeout(() => {
            window.location.href = 'login.html';
          }, 2000);
        } else {
          // ERROR - (e.g., user exists, invalid email format)
          showToast(data.msg || "Sign up failed.", true);
        }
      } catch (error) {
        showToast("Network error. Could not reach server.", true);
        console.error('Fetch error:', error);
      }
    });
</script>